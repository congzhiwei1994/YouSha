
从需求出发，设计3D流水线。

## 需求：

给定一组3D坐标/模型数据，将其显示到屏幕上

##### 输入:  

1.美术的现代投影理论：近大远小。  
2.有模型（数据都是3D坐标Vector3）  

##### 输出：

屏幕是2D，其实就是一个二维数组，数组中存的是像素


---
## 设计

总览：
![image.png](https://cong1994-1316732557.cos.ap-guangzhou.myqcloud.com/Obsidian/Image/202302251433011.png)

**1. 顶点着色器阶段**

此阶段将顶点坐标进行变换，从本地空间 => 世界空间 => 相机空间 => 裁剪空间。所用到的矩阵依次是 模型矩阵(model matrix),视矩阵(view matrix),投影矩阵(projection matrix)

**2. 图元组装阶段**

此阶段发生在光栅化之前，在此阶段进行裁剪剔除和屏幕映射操作。裁剪是裁剪掉超过视锥体之外的三角形，并且重新组装成新的三角形。剔除是剔除掉模型背面的三角形。裁剪剔除操作的目的就是减少进入光栅化的图元的数量，加速渲染过程。

屏幕映射操作包括透视除法和视口变换。裁剪空间下的顶点坐标经过透视除法之后会被规范化到一个CVV立方体内，转换到NDC坐标，同时经过透视除法之后就会实现透视投影的近大远小的效果。

视口变换，经过视口变换之后可以得到窗口坐标。

**3. 光栅化阶段**

此阶段主要是将变换到屏幕上的图元离散化成片元的过程

**4. 片段着色器**
此阶段主要进行对片元的着色。

**5. 混合测试**
此阶段片元通过各种测试和混合形成像素。

